{"ast":null,"code":"var _jsxFileName = \"/home/xs436-anikum/Desktop/libsis/frontend/src/hooks/AuthProvider.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useState } from \"react\";\nimport { LoginCall, LogoutCall } from \"./apicall\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  return useContext(AuthContext);\n};\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport function AuthProvider({\n  children\n}) {\n  _s2();\n  const [user, setUser] = useState({});\n  const [token, setToken] = useState({});\n  const [Role, setRole] = useState({});\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [loginErr, setLoginErr] = useState(\"\");\n  function Login(email, password) {\n    return LoginCall(email, password).then(function (response) {\n      setIsAuthenticated(true);\n      setUser(response.data.User);\n      setRole(response.data.User.role);\n      setToken(response.data.Token);\n      setLoginErr(\"\");\n      localStorage.setItem('isLogin', true);\n      localStorage.setItem('Token', response.data.Token);\n      localStorage.setItem('User', JSON.stringify(response.data.User));\n      localStorage.setItem('Role', response.data.User.role);\n      return true;\n    }).catch(function (err) {\n      var _err$response;\n      setIsAuthenticated(false);\n      setUser(null);\n      setToken(null);\n      setRole(null);\n      setLoginErr(err.response.data);\n      console.log(err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data);\n      throw new Error(err.response.data);\n    });\n  }\n  useEffect(() => {\n    const isAuth = Boolean(localStorage.getItem(\"isLogin\"));\n    const user = localStorage.getItem(\"User\");\n    const Token = localStorage.getItem(\"Token\");\n    const Role = localStorage.getItem(\"Role\");\n    setIsAuthenticated(isAuth);\n    setUser(user);\n    setToken(Token);\n    setRole(Role);\n  }, []);\n  function RegisterLibrary(name, email, password, contactnumber, libname) {\n    return RegisterLibraryCal();\n  }\n  function Logout() {\n    return LogoutCall().then(res => {\n      setIsAuthenticated(false);\n      setUser(null);\n      setToken(null);\n      localStorage.removeItem(\"isLogin\");\n      localStorage.removeItem(\"User\");\n      localStorage.removeItem(\"Token\");\n      localStorage.removeItem(\"Role\");\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      isAuthenticated,\n      Login,\n      Logout,\n      RegisterLibrary,\n      user,\n      token,\n      Role,\n      loginErr\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 9\n  }, this);\n}\n_s2(AuthProvider, \"CCVygqgVnGGsri3i5zHGeHDMhlQ=\");\n_c = AuthProvider;\nexport default AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","LoginCall","LogoutCall","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","AuthProvider","children","_s2","user","setUser","token","setToken","Role","setRole","isAuthenticated","setIsAuthenticated","loginErr","setLoginErr","Login","email","password","then","response","data","User","role","Token","localStorage","setItem","JSON","stringify","catch","err","_err$response","console","log","Error","isAuth","Boolean","getItem","RegisterLibrary","name","contactnumber","libname","RegisterLibraryCal","Logout","res","removeItem","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/xs436-anikum/Desktop/libsis/frontend/src/hooks/AuthProvider.jsx"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\nimport { LoginCall, LogoutCall } from \"./apicall\";\n\nexport const AuthContext = createContext()\n\nexport const useAuth =\n    () => useContext(AuthContext)\n\nexport function AuthProvider({ children }) {\n    const [user, setUser] = useState({})\n    const [token, setToken] = useState({})\n    const [Role, setRole] = useState({})\n\n    const [isAuthenticated, setIsAuthenticated] = useState(false)\n    const [loginErr, setLoginErr] = useState(\"\")\n\n    function Login(email, password) {\n        return (LoginCall(email, password).then(function (response) {\n            setIsAuthenticated(true)\n            setUser(response.data.User)\n            setRole(response.data.User.role)\n            setToken(response.data.Token)\n            setLoginErr(\"\")\n            localStorage.setItem('isLogin', true)\n            localStorage.setItem('Token', response.data.Token);\n            localStorage.setItem('User', JSON.stringify(response.data.User));\n            localStorage.setItem('Role', response.data.User.role);\n\n            return true\n\n        }).catch(function (err) {\n            setIsAuthenticated(false)\n            setUser(null)\n            setToken(null)\n            setRole(null)\n\n            setLoginErr(err.response.data)\n            console.log(err?.response?.data)\n            throw new Error(err.response.data)\n        })\n        )\n    }\n\n    useEffect(() => {\n        const isAuth =Boolean(localStorage.getItem(\"isLogin\"))\n        const user = localStorage.getItem(\"User\")\n        const Token = localStorage.getItem(\"Token\")\n        const Role = localStorage.getItem(\"Role\")\n\n        setIsAuthenticated(isAuth)\n        setUser(user)\n        setToken(Token)\n        setRole(Role)\n\n    }, [])\n\n    function RegisterLibrary(name,email,password,contactnumber,libname){\n            return RegisterLibraryCal()\n    }\n\n\n\n    function Logout() {\n      \n\n        return(LogoutCall().then((res)=>{\n            setIsAuthenticated(false);\n            setUser(null)\n            setToken(null)\n            localStorage.removeItem(\"isLogin\");\n            localStorage.removeItem(\"User\");\n            localStorage.removeItem(\"Token\");\n            localStorage.removeItem(\"Role\");\n\n        }))\n\n    }\n    return (\n        <AuthContext.Provider value={{ isAuthenticated, Login, Logout,RegisterLibrary, user,token,Role, loginErr }}>\n            {children}\n        </AuthContext.Provider>\n    )\n}\n\nexport default  AuthProvider;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}